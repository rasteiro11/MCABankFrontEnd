<div class="client-detail-container" *ngIf="client">
  <div class="header">
    <button *ngIf="dialogRef" mat-icon-button (click)="closeDialog()">
      <mat-icon>close</mat-icon>
    </button>
    <button *ngIf="!dialogRef" mat-icon-button routerLink="/clients">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <div class="client-info">
      <div class="client-avatar">
        <mat-icon>person</mat-icon>
      </div>
      <div class="client-details">
        <h2>{{ client.nome }}</h2>
        <p>{{ client.email }}</p>
      </div>
    </div>
    <div class="spacer"></div>
  </div>

  <div class="content">
    <mat-tab-group>
      <mat-tab style="font-family: 'Montserrat', 'Segoe UI', Arial, sans-serif; font-weight: 300; font-size: 20px; color: #333;" label="Informações">
        <div class="tab-content">
          <div class="info-grid">
            <mat-card>
              <mat-card-header>
                <mat-card-title>Dados Pessoais</mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <div class="info-row">
                  <label>Nome Completo:</label>
                  <span>{{ client.nome }}</span>
                </div>
                <div class="info-row">
                  <label>Email:</label>
                  <span>{{ client.email }}</span>
                </div>
                <div class="info-row">
                  <label>Data de Cadastro:</label>
                  <span>{{ client.dataCadastro | date:'dd/MM/yyyy' }}</span>
                </div>
                <div class="info-row">
                  <label>Status:</label>
                  <span class="status-badge" [class.active]="true">
                    {{ 'Ativo' }}
                  </span>
                </div>
              </mat-card-content>
            </mat-card>

            <mat-card class="balance-card">
              <mat-card-content>
                <div class="balance-info">
                  <mat-icon class="balance-icon">account_balance_wallet</mat-icon>
                  <div class="balance-details">
                    <h3>Saldo Atual</h3>
                    <div class="balance-amount">
                      {{ client.saldo | currency:'BRL':'symbol':'1.2-2' }}
                    </div>
                  </div>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </mat-tab>

      <mat-tab style="font-family: 'Montserrat', 'Segoe UI', Arial, sans-serif; font-weight: 300; font-size: 20px; color: #333;" label="Operações Bancárias">
        <div class="tab-content operations-tab-content">
          <div class="operations-grid">
            <mat-card>
              <mat-card-header>
                <mat-card-title>Depósito</mat-card-title>
              </mat-card-header>
              <mat-card-content class="deposit-card-content">
                <form [formGroup]="depositForm" (ngSubmit)="deposit()" class="deposit-form">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Valor do Depósito</mat-label>
                    <input matInput type="number" formControlName="amount" min="0.01" step="0.01">
                    <span matPrefix>R$ </span>
                    <mat-error *ngIf="depositForm.get('amount')?.hasError('required')">
                      Valor é obrigatório
                    </mat-error>
                    <mat-error *ngIf="depositForm.get('amount')?.hasError('min')">
                      Valor deve ser maior que zero
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Descrição (opcional)</mat-label>
                    <input matInput formControlName="descricao">
                  </mat-form-field>

                  <div class="deposit-form-spacer"></div>

                  <button mat-raised-button color="primary" type="submit" 
                          [disabled]="depositForm.invalid || depositLoading" class="full-width deposit-btn">
                    <mat-spinner *ngIf="depositLoading" diameter="20"></mat-spinner>
                    <mat-icon *ngIf="!depositLoading">add</mat-icon>
                    {{ depositLoading ? '' : 'Depositar' }}
                  </button>
                </form>
              </mat-card-content>
            </mat-card>

            <mat-card>
              <mat-card-header style="margin-bottom: 16px;">
                <mat-card-title>Saque</mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <form [formGroup]="withdrawForm" (ngSubmit)="withdraw()">
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Valor do Saque</mat-label>
                    <input matInput type="number" formControlName="amount" min="0.01" step="0.01" [max]="client.saldo">
                    <span matPrefix>R$ </span>
                    <mat-error *ngIf="withdrawForm.get('amount')?.hasError('required')">
                      Valor é obrigatório
                    </mat-error>
                    <mat-error *ngIf="withdrawForm.get('amount')?.hasError('min')">
                      Valor deve ser maior que zero
                    </mat-error>
                    <mat-error *ngIf="withdrawForm.get('amount')?.hasError('max')">
                      Valor não pode ser maior que o saldo
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Descrição (opcional)</mat-label>
                    <input matInput formControlName="descricao">
                  </mat-form-field>

                  <div class="balance-info-small balance-info-centered">
                    <mat-icon color="primary">account_balance_wallet</mat-icon>
                    <span>Saldo disponível:</span>
                    <span class="balance-amount-available">{{ client.saldo | currency:'BRL':'symbol':'1.2-2' }}</span>
                  </div>

                  <button mat-raised-button color="warn" type="submit" 
                          [disabled]="withdrawForm.invalid || withdrawLoading || client.saldo <= 0" class="full-width">
                    <mat-spinner *ngIf="withdrawLoading" diameter="20"></mat-spinner>
                    <mat-icon *ngIf="!withdrawLoading">remove</mat-icon>
                    {{ withdrawLoading ? '' : 'Sacar' }}
                  </button>
                </form>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>